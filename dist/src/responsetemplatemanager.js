"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var responseparser_1 = require("./responseparser");
var responsetemplate_1 = require("./responsetemplate");
var ResponseTemplateManager = (function () {
    function ResponseTemplateManager() {
        this.templates = {
            404: this.generateTemplate("421", "Page not found"),
            500: this.generateTemplate("500", "Internal server error"),
            empty: this.generateTemplate("423", "Empty API response. Probably unreachable API end point {CONNECTION_URL}"),
            error: this.generateTemplate("421", "Command failed due to server error. Client should try again"),
            expired: this.generateTemplate("530", "SESSION NOT FOUND"),
            httperror: this.generateTemplate("421", "Command failed due to HTTP communication error"),
            invalid: this.generateTemplate("423", "Invalid API response. Contact Support"),
            unauthorized: this.generateTemplate("530", "Unauthorized"),
        };
    }
    ResponseTemplateManager.getInstance = function () {
        if (!ResponseTemplateManager.instance) {
            ResponseTemplateManager.instance = new ResponseTemplateManager();
        }
        return ResponseTemplateManager.instance;
    };
    ResponseTemplateManager.prototype.generateTemplate = function (code, description) {
        return "[RESPONSE]\r\nCODE=" + code + "\r\nDESCRIPTION=" + description + "\r\nEOF\r\n";
    };
    ResponseTemplateManager.prototype.addTemplate = function (id, plain) {
        this.templates[id] = plain;
        return ResponseTemplateManager.instance;
    };
    ResponseTemplateManager.prototype.getTemplate = function (id) {
        if (this.hasTemplate(id)) {
            return new responsetemplate_1.ResponseTemplate(this.templates[id]);
        }
        return new responsetemplate_1.ResponseTemplate(this.generateTemplate("500", "Response Template not found"));
    };
    ResponseTemplateManager.prototype.getTemplates = function () {
        var _this = this;
        var tpls = {};
        Object.keys(this.templates).forEach(function (key) {
            tpls[key] = new responsetemplate_1.ResponseTemplate(_this.templates[key]);
        });
        return tpls;
    };
    ResponseTemplateManager.prototype.hasTemplate = function (id) {
        return Object.prototype.hasOwnProperty.call(this.templates, id);
    };
    ResponseTemplateManager.prototype.isTemplateMatchHash = function (tpl2, id) {
        var h = this.getTemplate(id).getHash();
        return ((h.CODE === tpl2.CODE) &&
            (h.DESCRIPTION === tpl2.DESCRIPTION));
    };
    ResponseTemplateManager.prototype.isTemplateMatchPlain = function (plain, id) {
        var h = this.getTemplate(id).getHash();
        var tpl2 = responseparser_1.ResponseParser.parse(plain);
        return ((h.CODE === tpl2.CODE) &&
            (h.DESCRIPTION === tpl2.DESCRIPTION));
    };
    return ResponseTemplateManager;
}());
exports.ResponseTemplateManager = ResponseTemplateManager;
ResponseTemplateManager.getInstance();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzcG9uc2V0ZW1wbGF0ZW1hbmFnZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvcmVzcG9uc2V0ZW1wbGF0ZW1hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxtREFBa0Q7QUFDbEQsdURBQXNEO0FBS3REO0lBb0JJO1FBQ0ksSUFBSSxDQUFDLFNBQVMsR0FBRztZQUNiLEdBQUcsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLGdCQUFnQixDQUFDO1lBQ25ELEdBQUcsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLHVCQUF1QixDQUFDO1lBQzFELEtBQUssRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLHlFQUF5RSxDQUFDO1lBQzlHLEtBQUssRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLDZEQUE2RCxDQUFDO1lBQ2xHLE9BQU8sRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLG1CQUFtQixDQUFDO1lBQzFELFNBQVMsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLGdEQUFnRCxDQUFDO1lBQ3pGLE9BQU8sRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLHVDQUF1QyxDQUFDO1lBQzlFLFlBQVksRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLGNBQWMsQ0FBQztTQUM3RCxDQUFDO0lBQ04sQ0FBQztJQTFCYSxtQ0FBVyxHQUF6QjtRQUNJLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxRQUFRLEVBQUU7WUFDbkMsdUJBQXVCLENBQUMsUUFBUSxHQUFHLElBQUksdUJBQXVCLEVBQUUsQ0FBQztTQUNwRTtRQUNELE9BQU8sdUJBQXVCLENBQUMsUUFBUSxDQUFDO0lBQzVDLENBQUM7SUE2Qk0sa0RBQWdCLEdBQXZCLFVBQXdCLElBQVksRUFBRSxXQUFtQjtRQUNyRCxPQUFPLHdCQUFzQixJQUFJLHdCQUFtQixXQUFXLGdCQUFhLENBQUM7SUFDakYsQ0FBQztJQVFNLDZDQUFXLEdBQWxCLFVBQW1CLEVBQVUsRUFBRSxLQUFhO1FBQ3hDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDO1FBQzNCLE9BQU8sdUJBQXVCLENBQUMsUUFBUSxDQUFDO0lBQzVDLENBQUM7SUFPTSw2Q0FBVyxHQUFsQixVQUFtQixFQUFVO1FBQ3pCLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsRUFBRTtZQUN0QixPQUFPLElBQUksbUNBQWdCLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1NBQ25EO1FBQ0QsT0FBTyxJQUFJLG1DQUFnQixDQUN2QixJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLDZCQUE2QixDQUFDLENBQzlELENBQUM7SUFDTixDQUFDO0lBTU0sOENBQVksR0FBbkI7UUFBQSxpQkFNQztRQUxHLElBQU0sSUFBSSxHQUFRLEVBQUUsQ0FBQztRQUNyQixNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxHQUFHO1lBQ3BDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLG1DQUFnQixDQUFDLEtBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMxRCxDQUFDLENBQUMsQ0FBQztRQUNILE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFPTSw2Q0FBVyxHQUFsQixVQUFtQixFQUFVO1FBQ3pCLE9BQU8sTUFBTSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDcEUsQ0FBQztJQVFNLHFEQUFtQixHQUExQixVQUEyQixJQUFTLEVBQUUsRUFBVTtRQUM1QyxJQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ3pDLE9BQU8sQ0FDSCxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLElBQUksQ0FBQztZQUN0QixDQUFDLENBQUMsQ0FBQyxXQUFXLEtBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUN2QyxDQUFDO0lBQ04sQ0FBQztJQVFNLHNEQUFvQixHQUEzQixVQUE0QixLQUFhLEVBQUUsRUFBVTtRQUNqRCxJQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ3pDLElBQU0sSUFBSSxHQUFHLCtCQUFjLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3pDLE9BQU8sQ0FDSCxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLElBQUksQ0FBQztZQUN0QixDQUFDLENBQUMsQ0FBQyxXQUFXLEtBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUN2QyxDQUFDO0lBQ04sQ0FBQztJQUNMLDhCQUFDO0FBQUQsQ0FBQyxBQXJIRCxJQXFIQztBQXJIWSwwREFBdUI7QUF1SHBDLHVCQUF1QixDQUFDLFdBQVcsRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVzcG9uc2VQYXJzZXIgfSBmcm9tIFwiLi9yZXNwb25zZXBhcnNlclwiO1xuaW1wb3J0IHsgUmVzcG9uc2VUZW1wbGF0ZSB9IGZyb20gXCIuL3Jlc3BvbnNldGVtcGxhdGVcIjtcblxuLyoqXG4gKiBSZXNwb25zZVRlbXBsYXRlTWFuYWdlciBTaW5nbGV0b24gQ2xhc3NcbiAqL1xuZXhwb3J0IGNsYXNzIFJlc3BvbnNlVGVtcGxhdGVNYW5hZ2VyIHtcbiAgICAvKipcbiAgICAgKiBHZXQgUmVzcG9uc2VUZW1wbGF0ZU1hbmFnZXIgSW5zdGFuY2VcbiAgICAgKiBAcmV0dXJucyBSZXNwb25zZVRlbXBsYXRlTWFuYWdlciBJbnN0YW5jZVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogUmVzcG9uc2VUZW1wbGF0ZU1hbmFnZXIge1xuICAgICAgICBpZiAoIVJlc3BvbnNlVGVtcGxhdGVNYW5hZ2VyLmluc3RhbmNlKSB7XG4gICAgICAgICAgICBSZXNwb25zZVRlbXBsYXRlTWFuYWdlci5pbnN0YW5jZSA9IG5ldyBSZXNwb25zZVRlbXBsYXRlTWFuYWdlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBSZXNwb25zZVRlbXBsYXRlTWFuYWdlci5pbnN0YW5jZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzcG9uc2VUZW1wbGF0ZU1hbmFnZXIgSW5zdGFuY2VcbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUmVzcG9uc2VUZW1wbGF0ZU1hbmFnZXI7XG4gICAgLyoqXG4gICAgICogdGVtcGxhdGUgY29udGFpbmVyXG4gICAgICovXG4gICAgcHJpdmF0ZSB0ZW1wbGF0ZXM6IGFueTtcblxuICAgIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVzID0ge1xuICAgICAgICAgICAgNDA0OiB0aGlzLmdlbmVyYXRlVGVtcGxhdGUoXCI0MjFcIiwgXCJQYWdlIG5vdCBmb3VuZFwiKSxcbiAgICAgICAgICAgIDUwMDogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlKFwiNTAwXCIsIFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIpLFxuICAgICAgICAgICAgZW1wdHk6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZShcIjQyM1wiLCBcIkVtcHR5IEFQSSByZXNwb25zZS4gUHJvYmFibHkgdW5yZWFjaGFibGUgQVBJIGVuZCBwb2ludCB7Q09OTkVDVElPTl9VUkx9XCIpLFxuICAgICAgICAgICAgZXJyb3I6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZShcIjQyMVwiLCBcIkNvbW1hbmQgZmFpbGVkIGR1ZSB0byBzZXJ2ZXIgZXJyb3IuIENsaWVudCBzaG91bGQgdHJ5IGFnYWluXCIpLFxuICAgICAgICAgICAgZXhwaXJlZDogdGhpcy5nZW5lcmF0ZVRlbXBsYXRlKFwiNTMwXCIsIFwiU0VTU0lPTiBOT1QgRk9VTkRcIiksXG4gICAgICAgICAgICBodHRwZXJyb3I6IHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZShcIjQyMVwiLCBcIkNvbW1hbmQgZmFpbGVkIGR1ZSB0byBIVFRQIGNvbW11bmljYXRpb24gZXJyb3JcIiksXG4gICAgICAgICAgICBpbnZhbGlkOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGUoXCI0MjNcIiwgXCJJbnZhbGlkIEFQSSByZXNwb25zZS4gQ29udGFjdCBTdXBwb3J0XCIpLFxuICAgICAgICAgICAgdW5hdXRob3JpemVkOiB0aGlzLmdlbmVyYXRlVGVtcGxhdGUoXCI1MzBcIiwgXCJVbmF1dGhvcml6ZWRcIiksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgQVBJIHJlc3BvbnNlIHRlbXBsYXRlIHN0cmluZyBmb3IgZ2l2ZW4gY29kZSBhbmQgZGVzY3JpcHRpb25cbiAgICAgKiBAcGFyYW0gY29kZSBBUEkgcmVzcG9uc2UgY29kZVxuICAgICAqIEBwYXJhbSBkZXNjcmlwdGlvbiBBUEkgcmVzcG9uc2UgZGVzY3JpcHRpb25cbiAgICAgKiBAcmV0dXJucyBnZW5lcmF0ZSByZXNwb25zZSB0ZW1wbGF0ZSBzdHJpbmdcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2VuZXJhdGVUZW1wbGF0ZShjb2RlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFtSRVNQT05TRV1cXHJcXG5DT0RFPSR7Y29kZX1cXHJcXG5ERVNDUklQVElPTj0ke2Rlc2NyaXB0aW9ufVxcclxcbkVPRlxcclxcbmA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIHJlc3BvbnNlIHRlbXBsYXRlIHRvIHRlbXBsYXRlIGNvbnRhaW5lclxuICAgICAqIEBwYXJhbSBpZCB0ZW1wbGF0ZSBpZFxuICAgICAqIEBwYXJhbSBwbGFpbiBBUEkgcGxhaW4gcmVzcG9uc2VcbiAgICAgKiBAcmV0dXJucyBSZXNwb25zZVRlbXBsYXRlTWFuYWdlciBpbnN0YW5jZSBmb3IgbWV0aG9kIGNoYWluaW5nXG4gICAgICovXG4gICAgcHVibGljIGFkZFRlbXBsYXRlKGlkOiBzdHJpbmcsIHBsYWluOiBzdHJpbmcpOiBSZXNwb25zZVRlbXBsYXRlTWFuYWdlciB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVzW2lkXSA9IHBsYWluO1xuICAgICAgICByZXR1cm4gUmVzcG9uc2VUZW1wbGF0ZU1hbmFnZXIuaW5zdGFuY2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHJlc3BvbnNlIHRlbXBsYXRlIGluc3RhbmNlIGZyb20gdGVtcGxhdGUgY29udGFpbmVyXG4gICAgICogQHBhcmFtIGlkIHRlbXBsYXRlIGlkXG4gICAgICogQHJldHVybnMgdGVtcGxhdGUgaW5zdGFuY2VcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0VGVtcGxhdGUoaWQ6IHN0cmluZyk6IFJlc3BvbnNlVGVtcGxhdGUge1xuICAgICAgICBpZiAodGhpcy5oYXNUZW1wbGF0ZShpZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2VUZW1wbGF0ZSh0aGlzLnRlbXBsYXRlc1tpZF0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2VUZW1wbGF0ZShcbiAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVUZW1wbGF0ZShcIjUwMFwiLCBcIlJlc3BvbnNlIFRlbXBsYXRlIG5vdCBmb3VuZFwiKSxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYWxsIGF2YWlsYWJsZSByZXNwb25zZSB0ZW1wbGF0ZXNcbiAgICAgKiBAcmV0dXJucyBhbGwgYXZhaWxhYmxlIHJlc3BvbnNlIHRlbXBsYXRlIGluc3RhbmNlc1xuICAgICAqL1xuICAgIHB1YmxpYyBnZXRUZW1wbGF0ZXMoKTogYW55IHtcbiAgICAgICAgY29uc3QgdHBsczogYW55ID0ge307XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMudGVtcGxhdGVzKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIHRwbHNba2V5XSA9IG5ldyBSZXNwb25zZVRlbXBsYXRlKHRoaXMudGVtcGxhdGVzW2tleV0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRwbHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgZ2l2ZW4gdGVtcGxhdGUgZXhpc3RzIGluIHRlbXBsYXRlIGNvbnRhaW5lclxuICAgICAqIEBwYXJhbSBpZCB0ZW1wbGF0ZSBpZFxuICAgICAqIEByZXR1cm5zIGJvb2xlYW4gcmVzdWx0XG4gICAgICovXG4gICAgcHVibGljIGhhc1RlbXBsYXRlKGlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLnRlbXBsYXRlcywgaWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGdpdmVuIEFQSSByZXNwb25zZSBoYXNoIG1hdGNoZXMgYSBnaXZlbiB0ZW1wbGF0ZSBieSBjb2RlIGFuZCBkZXNjcmlwdGlvblxuICAgICAqIEBwYXJhbSB0cGwyIGFwaSByZXNwb25zZSBoYXNoXG4gICAgICogQHBhcmFtIGlkIHRlbXBsYXRlIGlkXG4gICAgICogQHJldHVybnMgYm9vbGVhbiByZXN1bHRcbiAgICAgKi9cbiAgICBwdWJsaWMgaXNUZW1wbGF0ZU1hdGNoSGFzaCh0cGwyOiBhbnksIGlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgaCA9IHRoaXMuZ2V0VGVtcGxhdGUoaWQpLmdldEhhc2goKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIChoLkNPREUgPT09IHRwbDIuQ09ERSkgJiZcbiAgICAgICAgICAgIChoLkRFU0NSSVBUSU9OID09PSB0cGwyLkRFU0NSSVBUSU9OKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGdpdmVuIEFQSSBwbGFpbiByZXNwb25zZSBtYXRjaGVzIGEgZ2l2ZW4gdGVtcGxhdGUgYnkgY29kZSBhbmQgZGVzY3JpcHRpb25cbiAgICAgKiBAcGFyYW0gcGxhaW4gQVBJIHBsYWluIHJlc3BvbnNlXG4gICAgICogQHBhcmFtIGlkIHRlbXBsYXRlIGlkXG4gICAgICogQHJldHVybnMgYm9vbGVhbiByZXN1bHRcbiAgICAgKi9cbiAgICBwdWJsaWMgaXNUZW1wbGF0ZU1hdGNoUGxhaW4ocGxhaW46IHN0cmluZywgaWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBoID0gdGhpcy5nZXRUZW1wbGF0ZShpZCkuZ2V0SGFzaCgpO1xuICAgICAgICBjb25zdCB0cGwyID0gUmVzcG9uc2VQYXJzZXIucGFyc2UocGxhaW4pO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgKGguQ09ERSA9PT0gdHBsMi5DT0RFKSAmJlxuICAgICAgICAgICAgKGguREVTQ1JJUFRJT04gPT09IHRwbDIuREVTQ1JJUFRJT04pXG4gICAgICAgICk7XG4gICAgfVxufVxuXG5SZXNwb25zZVRlbXBsYXRlTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuIl19